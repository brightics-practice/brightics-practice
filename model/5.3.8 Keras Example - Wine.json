{"_type":"input-function","_hash":"8fbe7084a67231009c904eb40daa26975c0e4e1e","_func":{"label":"Keras Example - Wine","tags":[],"description":"Wine Data Train & Predict by Keras","type":"udf","specType":"udf","content":{"_label":"brightics.deeplearning.input_function","_description":"user_defined_input_function","_tags":[],"module":"brightics.deeplearning.input_function","name":"user_defined_input_function","params":{"code":{"_description":"Function Code","_label":"Function Code","_type":"code","_value":"import tensorflow as tf\nimport tensorflow.keras as keras\nimport pandas as pd\nimport numpy as np\nfrom keras.models import Input, Model\nfrom keras.models import Sequential\nfrom keras.layers.core import Dense, Activation\nfrom keras.optimizers import Adam\n\n# Data Preprocessing\nindata_train = pd.read_csv(\"D:/wine_train.csv\")\nindata_test = pd.read_csv(\"D:/wine_test.csv\")\n\nfeature_cols = [col for col in indata_train.columns if not col.startswith('quality')]\nlabel_cols = [col for col in indata_train.columns if col.startswith('quality_')]\nprint('feature_cols: {}\\n'.format(feature_cols))\nprint('label_cols {}\\n'.format(label_cols))\n\nX_train = indata_train[feature_cols].values.astype(np.float32)\ny_train = indata_train[label_cols].values.astype(np.int32)\nX_test = indata_test[feature_cols].values.astype(np.float32)\ny_test = indata_test[label_cols].values.astype(np.int32)\n\n# Model Train\nmodel = Sequential()\nmodel.add(Dense(50, input_shape=(X_train.shape[1],), activation='sigmoid')) #num_col=12\nmodel.add(Dense(100, activation='relu'))\nmodel.add(Dense(y_train.shape[1], activation='softmax')) # sigmoid / num_col=7\n\nmodel.compile(loss='categorical_crossentropy',\n\toptimizer=Adam(),\n\tmetrics=['accuracy'])\n\nhist = model.fit(X_train, y_train, batch_size=32, epochs=3000, verbose=0)\n\n# Model Test\ny_pred = model.predict(X_test)\ny_pred_class = model.predict_classes(X_test)\n\n# Evaluation\neval_result = model.evaluate(X_test, y_test, batch_size=32)\nprint(eval_result)","_control":"codeEditor","_optional":false},"parameters":{"module":"builtins","name":"dict","_description":"Parameters","_label":"Parameters","_type":"parameters","_optional":true,"params":{}}}}}}