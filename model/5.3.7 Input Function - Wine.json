{"_type":"input-function","_hash":"adbb604712d084a4ec8e0710c31f3e72ad0cf972","_func":{"label":"Input Function - Wine","tags":[],"description":"Input Function Example for Wine Data","type":"udf","specType":"udf","content":{"_label":"brightics.deeplearning.input_function","_description":"user_defined_input_function","_tags":[],"module":"brightics.deeplearning.input_function","name":"user_defined_input_function","params":{"code":{"_description":"Function Code","_label":"Function Code","_type":"code","_value":"def input_function(params=None):\n    import pandas as pd\n    import numpy as np\n    import tensorflow as tf\n\n    # Getting paramters\n    batch_size = params.get('batch_size',32)\n    mode = params.get('mode', 'train')\n\n    # Load input data\n    if mode == 'train':\n        csvfile = params['train_path']\n    else:\n        csvfile = params['test_path']\n    indata_train = pd.read_csv(csvfile)\n    \n    # Data Preprocessing\n    feature_cols = [col for col in indata_train.columns if not col.startswith('quality')]\n    label_cols = [col for col in indata_train.columns if col.startswith('quality_')]\n    print('feature_cols: {}\\n'.format(feature_cols))\n    print('label_cols {}\\n'.format(label_cols))\n\n    features = indata_train[feature_cols].values.astype(np.float32)\n    labels = indata_train[label_cols].values.astype(np.int32)\n    \n    # Convert the inputs to a Dataset.\n    dataset = tf.data.Dataset.from_tensor_slices((features,labels))\n    \n    if mode == 'train':\n        dataset = dataset.shuffle(100).batch(batch_size).repeat()\n    else:\n        dataset = dataset.batch(batch_size)\n    # Return dataset\n    return dataset\n    ","_control":"codeEditor","_optional":false},"parameters":{"module":"builtins","name":"dict","_description":"Parameters","_label":"Parameters","_type":"parameters","_optional":true,"params":{"batch_size":{"_label":"batch_size","_description":"","_type":"number","_value":32,"_optional":true,"_control":"input"},"mode":{"_label":"mode","_description":"","_type":"string","_value":"train","_optional":true,"_control":"input"},"train_path":{"_label":"train_path","_description":"","_type":"string","_value":"d:/wine_train.csv","_optional":false,"_control":"input"},"test_path":{"_label":"test_path","_description":"","_type":"string","_value":"d:/wine_test.csv","_optional":false,"_control":"input"}}}}}}}